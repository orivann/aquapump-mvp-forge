# This Dockerfile is for development.
# It uses a non-root user and an entrypoint script to avoid permission issues.
FROM node:20-alpine

ARG UID=1001
ARG GID=1001

# Create a non-root user and group
RUN addgroup -g $GID -S appgroup && adduser -u $UID -G appgroup -S appuser

WORKDIR /app

COPY package.json package-lock.json* ./
RUN npm install --legacy-peer-deps

COPY . .

COPY entrypoint.sh /usr/local/bin/
RUN chmod +x /usr/local/bin/entrypoint.sh

EXPOSE 8080

ENTRYPOINT ["entrypoint.sh"]
CMD ["npm", "run", "dev"]
